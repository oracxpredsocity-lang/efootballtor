{% extends "base.html" %}
{% block content %}
<section class="admin">
  {% if not authenticated %}
    <h2>Admin login</h2>
    {% if error %}
      <div class="error">{{ error }}</div>
    {% endif %}
    <form method="post" class="login-form">
      <label for="password">Mot de passe admin</label>
      <input name="password" id="password" type="password" required />
      <button type="submit" class="btn">Se connecter</button>
    </form>
    {% if config.get('ADMIN_TOKEN') %}
      <p>Vous pouvez aussi vous connecter avec un <strong>token</strong> via <code>/admin?token=VOTRE_TOKEN</code></p>
    {% endif %}
  {% else %}
    <h2>Admin Dashboard</h2>
    <div class="admin-actions">
      <button id="btn-refresh" class="btn">Recharger données</button>
      <button id="btn-logout" class="btn secondary" onclick="location.href='{{ url_for('admin_logout') }}'">Déconnexion</button>
    </div>
    <div id="admin-area">
      <p>Modifiez les joueurs et scores puis cliquez sur <strong>Sauvegarder</strong>.</p>
      <pre id="raw-json" class="raw-json"></pre>
      <div class="admin-controls">
        <button id="btn-edit-json" class="btn">Éditer JSON</button>
        <button id="btn-save-json" class="btn primary">Sauvegarder</button>
      </div>
      <textarea id="json-editor" class="json-editor" style="display:none;"></textarea>
    </div>
    <script>
      // pass admin token availability to template (for hint only)
    </script>
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
  {% endif %}
</section>
{% endblock %}
